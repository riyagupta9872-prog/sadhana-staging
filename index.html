<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RAPD Sadhana Tracker</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <!-- Login Screen -->
    <div id="login-screen" class="screen active">
        <div class="login-container">
            <h1>üïâÔ∏è RAPD Sadhana Tracker</h1>
            <p class="subtitle">Track Your Spiritual Progress</p>
            
            <!-- First Time Setup (Google) -->
            <div id="first-time-setup" style="display:none;">
                <h3 style="color: #667eea; margin-bottom: 20px;">First Time Setup</h3>
                <p style="color: #666; margin-bottom: 20px;">Sign up with Google, then set your email & password for daily login</p>
                <button id="google-signup-btn" class="google-btn">
                    <img src="https://www.gstatic.com/firebasejs/ui/2.0.0/images/auth/google.svg" alt="Google">
                    Continue with Google
                </button>
                <p class="toggle-auth">Already have an account? <span id="show-login-from-setup">Login</span></p>
            </div>

            <!-- Email/Password Setup (After Google) -->
            <div id="password-setup" style="display:none;">
                <h3 style="color: #667eea; margin-bottom: 20px;">Set Your Login Credentials</h3>
                <p style="color: #666; margin-bottom: 15px; font-size: 0.9em;">
                    Welcome! Set a password for quick daily login.
                </p>
                <input type="email" id="setup-email" placeholder="Email" readonly style="background: #f5f5f5;">
                <input type="password" id="setup-password" placeholder="Create Password (min 6 characters)" required>
                <input type="password" id="setup-password-confirm" placeholder="Confirm Password" required>
                <div style="margin: 15px 0; text-align: left;">
                    <label style="display: flex; align-items: center; gap: 8px; cursor: pointer; color: #666;">
                        <input type="checkbox" id="trust-device" checked>
                        <span>Trust this device (stay logged in)</span>
                    </label>
                </div>
                <button id="complete-setup-btn" class="primary-btn">Complete Setup</button>
            </div>
            
            <!-- Regular Login -->
            <div class="login-form">
                <input type="email" id="login-email" placeholder="Email" required>
                <input type="password" id="login-password" placeholder="Password" required>
                <div style="margin: 15px 0; text-align: left;">
                    <label style="display: flex; align-items: center; gap: 8px; cursor: pointer; color: #666;">
                        <input type="checkbox" id="remember-me" checked>
                        <span>Remember me</span>
                    </label>
                </div>
                <button id="login-btn" class="primary-btn">Login</button>
                <p class="toggle-auth">First time? <span id="show-signup">Sign Up with Google</span></p>
            </div>
        </div>
    </div>

    <!-- Main Dashboard -->
    <div id="dashboard-screen" class="screen">
        <header>
            <h1>üïâÔ∏è RAPD Sadhana Tracker</h1>
            <div class="header-right">
                <span id="user-name"></span>
                <button id="logout-btn" class="logout-btn">Logout</button>
            </div>
        </header>

        <nav class="tab-nav">
            <button class="tab-btn active" data-tab="entry">Entry</button>
            <button class="tab-btn" data-tab="reports">Reports</button>
            <button class="tab-btn" data-tab="charts">Charts</button>
        </nav>

        <!-- Entry Tab -->
        <div id="entry-tab" class="tab-content active">
            <div class="entry-container">
                <h2>Daily Sadhana Entry</h2>
                <form id="sadhana-form">
                    <div class="form-group">
                        <label>Date:</label>
                        <input type="date" id="sadhana-date" required>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label>Sleep Time:</label>
                            <input type="time" id="sleep-time" required>
                        </div>
                        <div class="form-group">
                            <label>Wakeup Time:</label>
                            <input type="time" id="wakeup-time" required>
                        </div>
                    </div>

                    <div class="form-group">
                        <label>Morning Program Completion Time:</label>
                        <input type="time" id="morning-program-time" required>
                        <small>Target: 4:45 AM for 25 marks</small>
                    </div>

                    <div class="form-group">
                        <label>Chanting Completion Time:</label>
                        <input type="time" id="chanting-time" required>
                        <small>Target: Before 9:00 AM for 25 marks</small>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label>Reading Minutes:</label>
                            <input type="number" id="reading-mins" min="0" value="0" required>
                        </div>
                        <div class="form-group">
                            <label>Hearing Minutes:</label>
                            <input type="number" id="hearing-mins" min="0" value="0" required>
                        </div>
                    </div>

                    <div class="form-group">
                        <label>Notes Revision Minutes:</label>
                        <input type="number" id="notes-mins" min="0" value="0" required>
                        <small>Target: 35 mins for 25 marks (Weekly total: 245 mins)</small>
                    </div>

                    <div class="form-group">
                        <label>Day Sleep Minutes:</label>
                        <input type="number" id="day-sleep-minutes" min="0" value="0" required>
                        <small>Max 60 mins for 10 marks</small>
                    </div>

                    <button type="submit" class="submit-btn">Submit Sadhana</button>
                </form>
            </div>
        </div>

        <!-- Reports Tab -->
        <div id="reports-tab" class="tab-content">
            <div class="reports-container">
                <h2>Sadhana Reports</h2>
                
                <div class="report-controls">
                    <select id="report-type">
                        <option value="daily">Daily Report</option>
                        <option value="weekly">Weekly Report</option>
                        <option value="monthly">Monthly Report</option>
                    </select>
                    <input type="date" id="report-date">
                    <button id="generate-report-btn" class="primary-btn">Generate Report</button>
                    <button id="download-excel-btn" class="download-btn">Download Excel</button>
                </div>

                <div id="report-display"></div>
            </div>
        </div>

        <!-- Charts Tab -->
        <div id="charts-tab" class="tab-content">
            <div class="charts-container">
                <h2>Progress Charts</h2>
                
                <div class="chart-controls">
                    <select id="chart-period">
                        <option value="daily">Last 7 Days</option>
                        <option value="weekly">Last 4 Weeks</option>
                        <option value="monthly">Last 6 Months</option>
                    </select>
                    <button id="refresh-charts-btn" class="primary-btn">Refresh Charts</button>
                </div>

                <div class="chart-section">
                    <h3>Total Score Progress</h3>
                    <canvas id="score-chart"></canvas>
                </div>

                <div class="chart-section">
                    <h3>Activity-wise Breakdown</h3>
                    <canvas id="activity-chart"></canvas>
                </div>
            </div>
        </div>
    </div>

    <!-- Firebase SDKs -->
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>
    
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    
    <!-- SheetJS for Excel -->
    <script src="https://cdn.sheetjs.com/xlsx-0.20.1/package/dist/xlsx.full.min.js"></script>
    
    <script src="app.js"></script>
</body>
</html>
